@model DynamicDataModel

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Table View</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/css/styles.css" asp-append-version="true" />

</head>
<body class="container mt-1">
    
    <!-- Search Section -->
    <div class="masterdiv mb-12">
        
        <div class="row mt-3">
            <div class="col-md-2"><input type="text" name="textSearchStore" id="textSearchStore" class="selectorinput form-control" placeholder="Store" onkeyup="StoreFilter()"></div>
            <div class="col-md-2"><input type="text" name="textSearchdealerCode" id="textSearchdealerCode" class="selectorinput form-control" placeholder="Dealer Code" onkeyup="DealerCodeFilter()"></div>
            <div class="col-md-2"><input type="text" name="textSearchMarket" id="textSearchMarket" class="selectorinput form-control" placeholder="Market" onkeyup="MarketFilter()"></div>
            <div class="col-md-2"><input type="text" name="textSearchTM" id="textSearchTM" class="selectorinput form-control" placeholder="TM" onkeyup="TMFilter()"></div>
            <div class="col-md-2"><input type="text" name="textSearchRole" id="textSearchRole" class="selectorinput form-control" placeholder="Role" onkeyup="RoleFilter()"></div>


            <!-- Right-aligned section for Date picker and Icon -->
            <div class="d-flex align-items-center ms-auto col-md-2 dateIcon">
                <input type="date" id="selectedDate" name="selectedDate" class="form-control" title="Select Date" onchange="dateFilterTable()">
                <button type="submit" class="headerbtndiv btn ms-2 small-btn" title="First Load Data" id="" onclick="refresh()">
                    <i class="fas fa-retweet"></i>
                </button>
            </div>
        </div>
        <div class="row">
            <div class="col-md-2">
                <select class="form-control" id="Stores" multiple>
                    @foreach (var data in Model.TableData) 
                    {
                        @if (data.ContainsKey("Store")) 
                        {
                            <option class="optionfilter" value="@data["Store"]" title="@data["Store"]">@data["Store"]</option>
                        }
                    }
                </select>
            </div>
            <div class="col-md-2">
                <select class="form-control" id="DealerCode" multiple>
                    @foreach (var data in Model.TableData)
                    {
                        @if (data.ContainsKey("Dealer Code"))
                        {
                            <option class="optionfilter" value="@data["Dealer Code"]" title="@data["Dealer Code"]">@data["Dealer Code"]</option>
                        }
                    }
                </select>
            </div>
            <div class="col-md-2">
                <select class="form-control" id="Market" multiple>
                    @foreach (var data in Model.TableData)
                    {
                        @if (data.ContainsKey("Market"))
                        {
                            <option class="optionfilter" value="@data["Market"]" title="@data["Market"]">@data["Market"]</option>
                        }
                    }
                </select>
            </div>
            <div class="col-md-2">
                <select class="form-control" id="TM" multiple>
                    @foreach (var data in Model.TableData)
                    {
                        @if (data.ContainsKey("TM"))
                        {
                            <option class="optionfilter" value="@data["TM"]" title="@data["TM"]">@data["TM"]</option>
                        }
                    }
                </select>
            </div>
            <div class="col-md-2">
                <select class="form-control" id="Role" multiple>
                    @foreach (var data in Model.TableData)
                    {
                        @if (data.ContainsKey("Role"))
                        {
                            <option class="optionfilter" value="@data["Role"]" title="@data["Role"]">@data["Role"]</option>
                        }
                    }
                </select>
            </div>
            
        </div>
        
    </div>
    

    <!-- Filter Section with Search Bar and Dropdown -->
    <div class="filter-section row g-3 mb-1 mt-1 filterSearchBar">
        <div class="col-md-6">
            <select id="filterColumn" class="form-select">
                <option value="">-- Select Column --</option>
                @foreach (var field in Model.FieldNames)
                {
                    <option value="@field">@field</option>
                }
            </select>
        </div>
        <div class="col-md-6">
            <input type="text" id="textSearchTable" class="form-control" placeholder="Search..." onkeyup="TableDataFilter()">
        </div>
    </div>

    <!-- Data Table -->
    <div class="table-container">
        <table id="dataTable" class="table table-striped table-bordered">
            <thead class="table-dark">
                <tr>
                    @foreach (var field in Model.FieldNames)
                    {
                        <th>@field</th>
                    }
                </tr>
            </thead>
            <tbody>
                @foreach (var row in Model.TotalSum)
                {
                    <tr id="grandTotalRow">
                        <td>Grand Total</td>
                        @foreach (var field in Model.FieldNames)
                        {
                            <td data-column="@field">@(row.ContainsKey(field) ? row[field] : "")</td>
                        }
                    </tr>

                }
                @foreach (var row in Model.TableData)
                {
                    <tr>
                        @foreach (var field in Model.FieldNames)
                        {
                            <td data-column="@field">@(row.ContainsKey(field) ? row[field] : "N/A")</td>
                        }
                    </tr>
                }
            </tbody>
        </table>
    </div>
    
    <script src="~/js/script.js" asp-append-version="true"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
